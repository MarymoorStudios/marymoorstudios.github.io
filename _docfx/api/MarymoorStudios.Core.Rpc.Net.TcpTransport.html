<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class TcpTransport </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class TcpTransport ">
      
      <meta name="description" content="Transport that acts as an adapter between a  and a .">
      <link rel="icon" href="../logo.svg">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../logo.svg" alt="Marymoor Studios Core">
            Marymoor Studios Core
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport">



  <h1 id="MarymoorStudios_Core_Rpc_Net_TcpTransport" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport" class="text-break">
Class TcpTransport  
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="MarymoorStudios.html">MarymoorStudios</a>.<a class="xref" href="MarymoorStudios.Core.html">Core</a>.<a class="xref" href="MarymoorStudios.Core.Rpc.html">Rpc</a>.<a class="xref" href="MarymoorStudios.Core.Rpc.Net.html">Net</a></dd></dl>
  <dl><dt>Assembly</dt><dd>MarymoorStudios.Core.Rpc.Net.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Transport that acts as an adapter between a <span class="xref">MarymoorStudios.Core.Rpc.CommChannel</span> and a <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.net.sockets.socket">Socket</a>.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public sealed class TcpTransport : Transport&lt;OwnedMem&lt;byte&gt;&gt;, IDisposable</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="https://dev.azure.com/marymoorstudios/Game/_apis/git/repositories/Game/items?api-version=1.0&amp;versionType=commit&amp;version=60ba276f678d66e94593fcb78c94b7f44df9f2cb&amp;path=/Core/MarymoorStudios.Core.Promises/Transport.cs">Transport</a>&lt;<a class="xref" href="https://dev.azure.com/marymoorstudios/Game/_apis/git/repositories/Game/items?api-version=1.0&amp;versionType=commit&amp;version=60ba276f678d66e94593fcb78c94b7f44df9f2cb&amp;path=/Core/MarymoorStudios.Core/OwnedMem.cs">OwnedMem</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.byte">byte</a>&gt;&gt;</div>
      <div><span class="xref">TcpTransport</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.idisposable">IDisposable</a></div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="MarymoorStudios.Core.Promises.Transport-1.html#MarymoorStudios_Core_Promises_Transport_1_Dispose">Transport&lt;OwnedMem&lt;byte&gt;&gt;.Dispose()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
  </dd></dl>






  <h2 class="section" id="properties">Properties
</h2>


  <a id="MarymoorStudios_Core_Rpc_Net_TcpTransport_ConsumerEvent_" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.ConsumerEvent*"></a>

  <h3 id="MarymoorStudios_Core_Rpc_Net_TcpTransport_ConsumerEvent" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.ConsumerEvent">
  ConsumerEvent
  
  </h3>

  <div class="markdown level1 summary"><p>Event to efficiently signal the consumer when items are available to read.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override WaitHandle ConsumerEvent { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.waithandle">WaitHandle</a></dt>
    <dd></dd>
  </dl>




  <h4 class="section" id="MarymoorStudios_Core_Rpc_Net_TcpTransport_ConsumerEvent_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This event only signals on the transition between an empty queue and having at least one item, so
the caller should read the queue to completion before waiting on this event.</p>
</div>




  <a id="MarymoorStudios_Core_Rpc_Net_TcpTransport_ProducerEvent_" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.ProducerEvent*"></a>

  <h3 id="MarymoorStudios_Core_Rpc_Net_TcpTransport_ProducerEvent" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.ProducerEvent">
  ProducerEvent
  
  </h3>

  <div class="markdown level1 summary"><p>Event to efficiently signal the producer when slots are available to write.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override WaitHandle ProducerEvent { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.threading.waithandle">WaitHandle</a></dt>
    <dd></dd>
  </dl>




  <h4 class="section" id="MarymoorStudios_Core_Rpc_Net_TcpTransport_ProducerEvent_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This event only signals on the transition between a full queue and having at least <code>threshold</code>
items, so the caller should write to the queue until full before waiting on this event.</p>
</div>




  <h2 class="section" id="methods">Methods
</h2>


  <a id="MarymoorStudios_Core_Rpc_Net_TcpTransport_Close_" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.Close*"></a>

  <h3 id="MarymoorStudios_Core_Rpc_Net_TcpTransport_Close_MarymoorStudios_Core_Promises_TransportFlags_" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.Close(MarymoorStudios.Core.Promises.TransportFlags)">
  Close(TransportFlags)
  
  </h3>

  <div class="markdown level1 summary"><p>Marks the buffer as closed atomically.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override bool Close(TransportFlags flags = TransportFlags.Closed)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>flags</code> <a class="xref" href="MarymoorStudios.Core.Promises.TransportFlags.html">TransportFlags</a></dt>
    <dd><p>Indicates which side(s) to close.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if the both sides have closed, false if only one side has closed as of this call.</p>
</dd>
  </dl>







  <h4 class="section" id="MarymoorStudios_Core_Rpc_Net_TcpTransport_Close_MarymoorStudios_Core_Promises_TransportFlags__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>No more items can be inserted after this call returns.</p>
<p>Either side (producer or consumer) can close the buffer.</p>
<p>
Typically, the consumer will continue to read items until <a class="xref" href="MarymoorStudios.Core.Promises.Transport-1.html#MarymoorStudios_Core_Promises_Transport_1_TryDequeue__0__">TryDequeue(out T)</a> indicates the
closure has been seen.  This ensures that all buffered items have been removed, regardless of which side
closed first.
</p>
<p>Both sides should close the buffer before the last side to close can then safely dispose.</p>
</div>




  <a id="MarymoorStudios_Core_Rpc_Net_TcpTransport_Dispose_" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.Dispose*"></a>

  <h3 id="MarymoorStudios_Core_Rpc_Net_TcpTransport_Dispose_System_Boolean_" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.Dispose(System.Boolean)">
  Dispose(bool)
  
  </h3>

  <div class="markdown level1 summary"><p>Standard dispose pattern for subclasses.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected override void Dispose(bool disposing)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>disposing</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if both native and managed resources are being disposed.  False if only native
resources (i.e. in finalizer).</p>
</dd>
  </dl>












  <a id="MarymoorStudios_Core_Rpc_Net_TcpTransport_TryDequeue_" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.TryDequeue*"></a>

  <h3 id="MarymoorStudios_Core_Rpc_Net_TcpTransport_TryDequeue_MarymoorStudios_Core_OwnedMem_System_Byte___" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.TryDequeue(MarymoorStudios.Core.OwnedMem{System.Byte}@)">
  TryDequeue(out OwnedMem&lt;byte&gt;)
  
  </h3>

  <div class="markdown level1 summary"><p>Attempt to remove an item from the front of the buffer.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override bool TryDequeue(out OwnedMem&lt;byte&gt; item)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>item</code> <a class="xref" href="https://dev.azure.com/marymoorstudios/Game/_apis/git/repositories/Game/items?api-version=1.0&amp;versionType=commit&amp;version=60ba276f678d66e94593fcb78c94b7f44df9f2cb&amp;path=/Core/MarymoorStudios.Core/OwnedMem.cs">OwnedMem</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.byte">byte</a>&gt;</dt>
    <dd><p>If successful, the item removed from the buffer, <code>default</code> otherwise.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if an item was successfully remove, false if the buffer is empty.</p>
</dd>
  </dl>







  <h4 class="section" id="MarymoorStudios_Core_Rpc_Net_TcpTransport_TryDequeue_MarymoorStudios_Core_OwnedMem_System_Byte____remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>If <code class="paramref">item</code> is successfully removed the caller takes ownership of it and is
responsible for releasing its resources.  If the attempt to dequeue fails then <code class="paramref">item</code> is
<code>default</code>.</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="MarymoorStudios.Core.Rpc.Exceptions.AbortedException.html">AbortedException</a></dt>
    <dd><p>If the buffer has been closed AND all buffered items have been read.</p>
</dd>
  </dl>



  <a id="MarymoorStudios_Core_Rpc_Net_TcpTransport_TryEnqueue_" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.TryEnqueue*"></a>

  <h3 id="MarymoorStudios_Core_Rpc_Net_TcpTransport_TryEnqueue_MarymoorStudios_Core_OwnedMem_System_Byte___" data-uid="MarymoorStudios.Core.Rpc.Net.TcpTransport.TryEnqueue(MarymoorStudios.Core.OwnedMem{System.Byte}@)">
  TryEnqueue(ref OwnedMem&lt;byte&gt;)
  
  </h3>

  <div class="markdown level1 summary"><p>Attempt to insert an item at the end of the buffer.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override bool TryEnqueue(ref OwnedMem&lt;byte&gt; item)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>item</code> <a class="xref" href="https://dev.azure.com/marymoorstudios/Game/_apis/git/repositories/Game/items?api-version=1.0&amp;versionType=commit&amp;version=60ba276f678d66e94593fcb78c94b7f44df9f2cb&amp;path=/Core/MarymoorStudios.Core/OwnedMem.cs">OwnedMem</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.byte">byte</a>&gt;</dt>
    <dd><p>The item to be inserted.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p>True if the item was inserted, false if the buffer is full.</p>
</dd>
  </dl>







  <h4 class="section" id="MarymoorStudios_Core_Rpc_Net_TcpTransport_TryEnqueue_MarymoorStudios_Core_OwnedMem_System_Byte____remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>On a successful insert the buffer takes ownership of <code class="paramref">item</code> and its value is set to
<code>default</code>.  If <code class="paramref">item</code> cannot be inserted (either because 'full' or 'closed') then false
is returned and <code class="paramref">item</code> is unmodified (still owned by the caller); the caller is then
responsible for releasing any resources.</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="MarymoorStudios.Core.Rpc.Exceptions.AbortedException.html">AbortedException</a></dt>
    <dd><p>If the buffer has already been closed.</p>
</dd>
  </dl>




</article>



      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
