<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Struct PromiseMethodBuilder </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Struct PromiseMethodBuilder ">
      
      <meta name="description" content="Enables the async keyword for methods that return a .">
      <link rel="icon" href="../logo.svg">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="https://marymoorstudios.com">
            <img id="logo" class="svg" src="../logo.svg" alt="Marymoor Studios Core">
            Marymoor Studios Core
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder">



  <h1 id="MarymoorStudios_Core_Promises_PromiseMethodBuilder" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder" class="text-break">
Struct PromiseMethodBuilder  
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="MarymoorStudios.html">MarymoorStudios</a>.<a class="xref" href="MarymoorStudios.Core.html">Core</a>.<a class="xref" href="MarymoorStudios.Core.Promises.html">Promises</a></dd></dl>
  <dl><dt>Assembly</dt><dd>MarymoorStudios.Core.Promises.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>Enables the <code>async</code> keyword for methods that return a <a class="xref" href="MarymoorStudios.Core.Promises.Promise.html">Promise</a>.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public struct PromiseMethodBuilder</code></pre>
  </div>







  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetype.equals">ValueType.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetype.gethashcode">ValueType.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.valuetype.tostring">ValueType.ToString()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
  </dd></dl>






  <h2 class="section" id="properties">Properties
</h2>


  <a id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_Task_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.Task*"></a>

  <h3 id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_Task" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.Task">
  Task
  
  </h3>

  <div class="markdown level1 summary"><p>A promise for the final outcome of an async methods.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Promise Task { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="MarymoorStudios.Core.Promises.Promise.html">Promise</a></dt>
    <dd></dd>
  </dl>




  <h4 class="section" id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_Task_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>Called by the compiler generated code at the callsite of an async method to retrieve a promise for
the methods eventual outcome.</p>
</div>




  <h2 class="section" id="methods">Methods
</h2>


  <a id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_AwaitOnCompleted_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.AwaitOnCompleted*"></a>

  <h3 id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_AwaitOnCompleted__2___0____1__" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.AwaitOnCompleted``2(``0@,``1@)">
  AwaitOnCompleted&lt;TAwaiter, TStateMachine&gt;(ref TAwaiter, ref TStateMachine)
  
  </h3>

  <div class="markdown level1 summary"><p>Schedule the resumption of an async method during a blocking await point for awaitables that only
implement the base <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.runtime.compilerservices.inotifycompletion">INotifyCompletion</a> notification style.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void AwaitOnCompleted&lt;TAwaiter, TStateMachine&gt;(ref TAwaiter awaiter, ref TStateMachine stateMachine) where TAwaiter : INotifyCompletion where TStateMachine : IAsyncStateMachine</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>awaiter</code> <span class="xref">TAwaiter</span></dt>
    <dd><p>The awaiter of the awaitable this async method is blocking on.</p>
</dd>
    <dt><code>stateMachine</code> <span class="xref">TStateMachine</span></dt>
    <dd><p>The state machine that captures the resumable state of this async method.</p>
</dd>
  </dl>


  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>TAwaiter</code></dt>
    <dd><p>The type of the awaiter of the awaitable this async method is blocking on.</p>
</dd>
    <dt><code>TStateMachine</code></dt>
    <dd><p>The anonymous type generated by the compiler to captured stack variables and
provide resumption logic for each await point.</p>
</dd>
  </dl>










  <a id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_AwaitUnsafeOnCompleted_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.AwaitUnsafeOnCompleted*"></a>

  <h3 id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_AwaitUnsafeOnCompleted__2___0____1__" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.AwaitUnsafeOnCompleted``2(``0@,``1@)">
  AwaitUnsafeOnCompleted&lt;TAwaiter, TStateMachine&gt;(ref TAwaiter, ref TStateMachine)
  
  </h3>

  <div class="markdown level1 summary"><p>Schedule the resumption of an async method during a blocking await point for awaitables that also
implement the newer <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.runtime.compilerservices.icriticalnotifycompletion">ICriticalNotifyCompletion</a> notification style.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void AwaitUnsafeOnCompleted&lt;TAwaiter, TStateMachine&gt;(ref TAwaiter awaiter, ref TStateMachine stateMachine) where TAwaiter : ICriticalNotifyCompletion where TStateMachine : IAsyncStateMachine</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>awaiter</code> <span class="xref">TAwaiter</span></dt>
    <dd><p>The awaiter of the awaitable this async method is blocking on.</p>
</dd>
    <dt><code>stateMachine</code> <span class="xref">TStateMachine</span></dt>
    <dd><p>The state machine that captures the resumable state of this async method.</p>
</dd>
  </dl>


  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>TAwaiter</code></dt>
    <dd><p>The type of the awaiter of the awaitable this async method is blocking on.</p>
</dd>
    <dt><code>TStateMachine</code></dt>
    <dd><p>The anonymous type generated by the compiler to captured stack variables and
provide resumption logic for each await point.</p>
</dd>
  </dl>










  <a id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_Create_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.Create*"></a>

  <h3 id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_Create" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.Create">
  Create()
  
  </h3>

  <div class="markdown level1 summary"><p>Factor method for this builder.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static PromiseMethodBuilder Create()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="MarymoorStudios.Core.Promises.PromiseMethodBuilder.html">PromiseMethodBuilder</a></dt>
    <dd><p>A new builder.</p>
</dd>
  </dl>







  <h4 class="section" id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_Create_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This is used by the generated code to create a new instance of the builder when an async method's is
first pushed on the stack.</p>
</div>




  <a id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_SetException_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.SetException*"></a>

  <h3 id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_SetException_System_Exception_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.SetException(System.Exception)">
  SetException(Exception)
  
  </h3>

  <div class="markdown level1 summary"><p>Resolve the return value with a failed outcome.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void SetException(Exception ex)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>ex</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>The error that caused the failure.</p>
</dd>
  </dl>








  <h4 class="section" id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_SetException_System_Exception__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>Called by the compiler generated code at any failure exit point from the async method to inform
callers of the final outcome.</p>
</div>




  <a id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_SetResult_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.SetResult*"></a>

  <h3 id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_SetResult" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.SetResult">
  SetResult()
  
  </h3>

  <div class="markdown level1 summary"><p>Resolve the return value with a successful outcome.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void SetResult()</code></pre>
  </div>









  <h4 class="section" id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_SetResult_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>Called by the compiler generated code at any successful exit point from the async method to inform
callers of the final outcome.</p>
</div>




  <a id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_SetStateMachine_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.SetStateMachine*"></a>

  <h3 id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_SetStateMachine_System_Runtime_CompilerServices_IAsyncStateMachine_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.SetStateMachine(System.Runtime.CompilerServices.IAsyncStateMachine)">
  SetStateMachine(IAsyncStateMachine)
  
  </h3>

  <div class="markdown level1 summary"><p>Hoists the state machine into the heap to be saved across a blocking await.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public readonly void SetStateMachine(IAsyncStateMachine stateMachine)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>stateMachine</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.runtime.compilerservices.iasyncstatemachine">IAsyncStateMachine</a></dt>
    <dd><p>The stack frame instance to be saved.</p>
</dd>
  </dl>












  <a id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_Start_" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.Start*"></a>

  <h3 id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_Start__1___0__" data-uid="MarymoorStudios.Core.Promises.PromiseMethodBuilder.Start``1(``0@)">
  Start&lt;TStateMachine&gt;(ref TStateMachine)
  
  </h3>

  <div class="markdown level1 summary"><p>Starts the async method's state machine.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public readonly void Start&lt;TStateMachine&gt;(ref TStateMachine stateMachine) where TStateMachine : IAsyncStateMachine</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>stateMachine</code> <span class="xref">TStateMachine</span></dt>
    <dd><p>An instance of <code class="typeparamref">TStateMachine</code> for the current stack frame.</p>
</dd>
  </dl>


  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>TStateMachine</code></dt>
    <dd><p>The anonymous type generated by the compiler to captured stack variables and
provide resumption logic for each await point.</p>
</dd>
  </dl>






  <h4 class="section" id="MarymoorStudios_Core_Promises_PromiseMethodBuilder_Start__1___0___remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>Note that <code class="paramref">stateMachine</code> is passed by <code>ref</code> here because it has been allocated
on the stack frame at this point.  It won't be hoisted to the heap (causing a heap allocation) until and
unless at least one of the await points actually blocks.  This is an optimization to avoid unnecessary heap
allocations if all awaitables turn out to already ben resolved (a common case in some circumstances).</p>
</div>





</article>



      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
